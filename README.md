# ğŸš€ åˆ†å¸ƒå¼æœåŠ¡æ’ä»¶åŒ–æ¡†æ¶

[![Go Version](https://img.shields.io/badge/Go-1.23+-brightgreen.svg)](https://golang.org)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Build Status](https://img.shields.io/badge/Build-Passing-brightgreen.svg)]()

ä¸€ä¸ªç°ä»£åŒ–çš„**åˆ†å¸ƒå¼æœåŠ¡æ’ä»¶åŒ–æ¡†æ¶**ï¼Œæ”¯æŒåŠ¨æ€æ’ä»¶ç®¡ç†ã€äº‹ä»¶é©±åŠ¨é€šä¿¡ã€å®šæ—¶ä»»åŠ¡è°ƒåº¦å’Œå¾®æœåŠ¡æ¶æ„ã€‚æ¡†æ¶å°†ä¼ ç»Ÿçš„å•ä½“æœåŠ¡è½¬æ¢ä¸ºé«˜åº¦æ¨¡å—åŒ–çš„æ’ä»¶ç³»ç»Ÿï¼Œæä¾›å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›å’Œçµæ´»çš„éƒ¨ç½²æ–¹æ¡ˆã€‚

## ğŸ“‹ ç›®å½•

- [æ ¸å¿ƒç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§)
- [æ¶æ„è®¾è®¡](#-æ¶æ„è®¾è®¡)
- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [æ’ä»¶ç³»ç»Ÿ](#-æ’ä»¶ç³»ç»Ÿ)
- [å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨](#-å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨)
- [APIæ–‡æ¡£](#-apiæ–‡æ¡£)
- [ä½¿ç”¨ç¤ºä¾‹](#-ä½¿ç”¨ç¤ºä¾‹)
- [éƒ¨ç½²æŒ‡å—](#-éƒ¨ç½²æŒ‡å—)
- [è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ§© æ’ä»¶åŒ–æ¶æ„
- **åŠ¨æ€æ’ä»¶ç®¡ç†**: è¿è¡Œæ—¶åŠ è½½ã€å¸è½½ã€é‡å¯æ’ä»¶
- **ä¾èµ–è§£æ**: è‡ªåŠ¨å¤„ç†æ’ä»¶ä¾èµ–å…³ç³»å’Œå¯åŠ¨é¡ºåº
- **ç”Ÿå‘½å‘¨æœŸç®¡ç†**: å®Œæ•´çš„æ’ä»¶ç”Ÿå‘½å‘¨æœŸæ§åˆ¶
- **æ¥å£æŠ½è±¡**: ç»Ÿä¸€çš„æ’ä»¶æ¥å£è®¾è®¡

### ğŸ“¡ äº‹ä»¶é©±åŠ¨é€šä¿¡
- **å¼‚æ­¥äº‹ä»¶æ€»çº¿**: æ’ä»¶é—´æ¾è€¦åˆé€šä¿¡
- **äº‹ä»¶è®¢é˜…å‘å¸ƒ**: æ”¯æŒå¤šç§äº‹ä»¶ç±»å‹å’Œå¤„ç†å™¨
- **å®æ—¶é€šçŸ¥**: æ’ä»¶çŠ¶æ€å˜åŒ–å®æ—¶æ¨é€

### â° å®šæ—¶ä»»åŠ¡è°ƒåº¦
- **å¤šç§è°ƒåº¦æ–¹å¼**: Cronè¡¨è¾¾å¼ã€é—´éš”æ—¶é—´ã€ä¸€æ¬¡æ€§ä»»åŠ¡
- **ä»»åŠ¡çŠ¶æ€ç®¡ç†**: è¿è¡Œã€æš‚åœã€æ¢å¤ã€å–æ¶ˆç­‰æ“ä½œ
- **æ‰§è¡Œç»Ÿè®¡**: è¿è¡Œæ¬¡æ•°ã€å¤±è´¥æ¬¡æ•°ã€æ€§èƒ½ç›‘æ§
- **äº‹ä»¶é›†æˆ**: ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€é€šè¿‡äº‹ä»¶ç³»ç»Ÿé€šçŸ¥

### ğŸŒ HTTPç®¡ç†æ¥å£
- **RESTful API**: å®Œæ•´çš„æ’ä»¶å’Œä»»åŠ¡ç®¡ç†æ¥å£
- **å®æ—¶ç›‘æ§**: æ’ä»¶çŠ¶æ€ã€ä»»åŠ¡æ‰§è¡Œæƒ…å†µæŸ¥è¯¢
- **Webæ§åˆ¶å°**: å‹å¥½çš„ç®¡ç†ç•Œé¢

### ğŸ”§ æœåŠ¡ç»„ä»¶é›†æˆ
- **Redis Cluster**: åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡
- **Apache Kafka**: æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡
- **Etcd**: é…ç½®ä¸­å¿ƒå’ŒæœåŠ¡å‘ç°
- **ç›‘æ§æŒ‡æ ‡**: Prometheusé›†æˆ
- **é“¾è·¯è¿½è¸ª**: OpenTelemetryæ”¯æŒ

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ’ä»¶åŒ–æœåŠ¡æ¡†æ¶                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  HTTP API     â”‚  äº‹ä»¶æ€»çº¿     â”‚  ä»»åŠ¡è°ƒåº¦å™¨    â”‚  æ’ä»¶ç®¡ç†å™¨    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        æ’ä»¶æ³¨å†Œè¡¨                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Redis        â”‚  Kafka       â”‚  Etcd        â”‚  è‡ªå®šä¹‰æ’ä»¶     â”‚
â”‚  æ’ä»¶          â”‚  æ’ä»¶         â”‚  æ’ä»¶         â”‚               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  HTTPä¼ è¾“      â”‚  gRPCä¼ è¾“     â”‚  WebSocket   â”‚  æ¶ˆæ¯é˜Ÿåˆ—      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           è®¤è¯æˆæƒ  â”‚  é™æµä¿æŠ¤  â”‚  ç›‘æ§æŒ‡æ ‡  â”‚  é“¾è·¯è¿½è¸ª          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | åŠŸèƒ½ | æè¿° |
|------|------|------|
| **Plugin Manager** | æ’ä»¶ç®¡ç† | æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€ä¾èµ–è§£æ |
| **Event Bus** | äº‹ä»¶é€šä¿¡ | å¼‚æ­¥äº‹ä»¶å‘å¸ƒè®¢é˜…æœºåˆ¶ |
| **Task Scheduler** | ä»»åŠ¡è°ƒåº¦ | Cron/é—´éš”/ä¸€æ¬¡æ€§ä»»åŠ¡è°ƒåº¦ |
| **Plugin Registry** | æ’ä»¶æ³¨å†Œ | æ’ä»¶æ³¨å†Œè¡¨å’ŒæœåŠ¡å‘ç° |
| **Config Provider** | é…ç½®ç®¡ç† | æ’ä»¶é…ç½®ç®¡ç†å’Œçƒ­æ›´æ–° |
| **Plugin Factory** | æ’ä»¶å·¥å‚ | åŠ¨æ€åˆ›å»ºæ’ä»¶å®ä¾‹ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.23+
- Redis (å¯é€‰)
- Kafka (å¯é€‰)
- Etcd (å¯é€‰)

### å®‰è£…è¿è¡Œ

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/qiaojinxia/distributed-service
cd distributed-service

# 2. å®‰è£…ä¾èµ–
go mod download

# 3. è¿è¡Œæ¼”ç¤ºç¨‹åº
cd examples/plugin_demo
go build -v
./plugin_demo
```

### è®¿é—®æœåŠ¡

å¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥è®¿é—®ä»¥ä¸‹åœ°å€ï¼š

- **ä¸»é¡µ**: http://localhost:8080/demo
- **æ’ä»¶ç®¡ç†**: http://localhost:8080/plugins/status
- **ä»»åŠ¡è°ƒåº¦**: http://localhost:8080/scheduler/tasks
- **ä»»åŠ¡æ¼”ç¤º**: http://localhost:8080/demo/scheduler

## ğŸ§© æ’ä»¶ç³»ç»Ÿ

### æ’ä»¶ç±»å‹

```go
// åŸºç¡€æ’ä»¶æ¥å£
type Plugin interface {
    Name() string
    Version() string
    Initialize(ctx context.Context, config Config) error
    Start(ctx context.Context) error
    Stop(ctx context.Context) error
    Status() Status
    Health() HealthStatus
}

// æœåŠ¡æ’ä»¶ - æä¾›å…·ä½“ä¸šåŠ¡æœåŠ¡
type ServicePlugin interface {
    Plugin
    GetService() interface{}
    GetEndpoints() []Endpoint
}

// ä¸­é—´ä»¶æ’ä»¶ - æä¾›ä¸­é—´ä»¶åŠŸèƒ½
type MiddlewarePlugin interface {
    Plugin
    GetMiddleware() interface{}
    Priority() int
}
```

### åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶

```go
// 1. ä½¿ç”¨æ„å»ºå™¨åˆ›å»ºæ’ä»¶
plugin := plugin.NewServicePluginBuilder("my-service", "v1.0.0", "è‡ªå®šä¹‰æœåŠ¡").
    Dependencies([]string{"logger", "config"}).
    Service(myService).
    Endpoint(plugin.Endpoint{
        Name: "health",
        Path: "/my-service/health",
        Method: "GET",
    }).
    OnInitialize(func(ctx context.Context, config plugin.Config) error {
        // åˆå§‹åŒ–é€»è¾‘
        return nil
    }).
    OnStart(func(ctx context.Context) error {
        // å¯åŠ¨é€»è¾‘
        return nil
    }).
    Build()

// 2. æ³¨å†Œæ’ä»¶
manager.GetRegistry().Register(plugin)

// 3. å¯åŠ¨æ’ä»¶
manager.StartPlugin("my-service")
```

### æ’ä»¶ç”Ÿå‘½å‘¨æœŸ

```mermaid
graph TD
    A[åˆ›å»ºæ’ä»¶] --> B[æ³¨å†Œæ’ä»¶]
    B --> C[åˆå§‹åŒ–]
    C --> D[å¯åŠ¨]
    D --> E[è¿è¡Œä¸­]
    E --> F[åœæ­¢]
    F --> G[é”€æ¯]
    
    E --> H[é‡å¯]
    H --> C
    
    C --> I[åˆå§‹åŒ–å¤±è´¥]
    D --> J[å¯åŠ¨å¤±è´¥]
    I --> K[å¤±è´¥çŠ¶æ€]
    J --> K
```

## â° å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨

### æ”¯æŒçš„è°ƒåº¦ç±»å‹

```go
// 1. Cronè¡¨è¾¾å¼è°ƒåº¦
task := plugin.NewTaskBuilder("cron-task", "å®šæ—¶ä»»åŠ¡").
    Cron("@every 1m").               // æ¯åˆ†é’Ÿæ‰§è¡Œ
    Handler(myTaskHandler).
    Build()

// 2. é—´éš”æ—¶é—´è°ƒåº¦
task := plugin.NewTaskBuilder("interval-task", "é—´éš”ä»»åŠ¡").
    Interval(30 * time.Second).      // æ¯30ç§’æ‰§è¡Œ
    MaxRuns(10).                     // æœ€å¤šæ‰§è¡Œ10æ¬¡
    Handler(myTaskHandler).
    Build()

// 3. ä¸€æ¬¡æ€§å»¶æ—¶ä»»åŠ¡
task := plugin.NewTaskBuilder("once-task", "ä¸€æ¬¡æ€§ä»»åŠ¡").
    Once(10 * time.Second).          // 10ç§’åæ‰§è¡Œä¸€æ¬¡
    Handler(myTaskHandler).
    Build()

// è°ƒåº¦ä»»åŠ¡
scheduler.ScheduleTask(task)
```

### ä»»åŠ¡çŠ¶æ€ç®¡ç†

| çŠ¶æ€ | æè¿° |
|------|------|
| `pending` | ç­‰å¾…æ‰§è¡Œ |
| `running` | æ­£åœ¨æ‰§è¡Œ |
| `paused` | å·²æš‚åœ |
| `completed` | å·²å®Œæˆ |
| `failed` | æ‰§è¡Œå¤±è´¥ |
| `canceled` | å·²å–æ¶ˆ |

### ä»»åŠ¡æ§åˆ¶

```go
// æš‚åœä»»åŠ¡
scheduler.PauseTask("task-id")

// æ¢å¤ä»»åŠ¡
scheduler.ResumeTask("task-id")

// å–æ¶ˆä»»åŠ¡
scheduler.CancelTask("task-id")

// æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
task := scheduler.GetTask("task-id")
fmt.Printf("ä»»åŠ¡çŠ¶æ€: %s, æ‰§è¡Œæ¬¡æ•°: %d", task.Status, task.RunCount)
```

## ğŸ“– APIæ–‡æ¡£

### æ’ä»¶ç®¡ç†API

```http
# è·å–æ‰€æœ‰æ’ä»¶çŠ¶æ€
GET /plugins/status

# é‡å¯æŒ‡å®šæ’ä»¶
POST /plugins/{name}/restart

# å‘å¸ƒæµ‹è¯•äº‹ä»¶
POST /plugins/events/test
```

### ä»»åŠ¡è°ƒåº¦API

```http
# è·å–æ‰€æœ‰ä»»åŠ¡
GET /scheduler/tasks

# åˆ›å»ºæ–°ä»»åŠ¡
POST /scheduler/tasks
Content-Type: application/json

{
  "id": "my-task",
  "name": "æˆ‘çš„ä»»åŠ¡",
  "description": "ä»»åŠ¡æè¿°",
  "schedule": {
    "type": "interval",
    "interval": "30s",
    "max_runs": 10
  }
}

# è·å–æŒ‡å®šä»»åŠ¡
GET /scheduler/tasks/{id}

# æš‚åœä»»åŠ¡
POST /scheduler/tasks/{id}/pause

# æ¢å¤ä»»åŠ¡  
POST /scheduler/tasks/{id}/resume

# å–æ¶ˆä»»åŠ¡
POST /scheduler/tasks/{id}/cancel

# è·å–è°ƒåº¦å™¨çŠ¶æ€
GET /scheduler/status
```

### å“åº”æ ¼å¼

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "task": {
      "id": "my-task",
      "name": "æˆ‘çš„ä»»åŠ¡",
      "status": "running",
      "run_count": 5,
      "created_at": "2024-01-01T10:00:00Z",
      "next_run_at": "2024-01-01T10:01:00Z"
    }
  }
}
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨

```go
package main

import (
    "github.com/qiaojinxia/distributed_service/framework/plugin"
    "time"
)

func main() {
    // 1. åˆ›å»ºæ’ä»¶ç®¡ç†å™¨
    manager := plugin.NewDefaultManager(&plugin.ManagerConfig{
        EnableDependencyCheck: true,
        HealthCheckInterval:   30 * time.Second,
    })
    
    // 2. è®¾ç½®æ—¥å¿—
    logger := plugin.NewSimplePluginLogger("demo")
    manager.SetLogger(logger)
    
    // 3. åˆ›å»ºå¹¶å¯åŠ¨è°ƒåº¦å™¨æ’ä»¶
    schedulerPlugin := plugin.NewSchedulerPlugin()
    manager.GetRegistry().Register(schedulerPlugin)
    manager.StartPlugin("scheduler")
    
    // 4. åˆ›å»ºå®šæ—¶ä»»åŠ¡
    task := plugin.NewTaskBuilder("log-task", "æ—¥å¿—ä»»åŠ¡").
        Cron("@every 1m").
        Handler(func(ctx context.Context, task *plugin.Task) error {
            log.Printf("å®šæ—¶ä»»åŠ¡æ‰§è¡Œ: %s", task.Name)
            return nil
        }).
        Build()
    
    // 5. è°ƒåº¦ä»»åŠ¡
    schedulerPlugin.ScheduleTask(task)
    
    // 6. å¯åŠ¨HTTPæœåŠ¡
    framework.Web(8080)
}
```

### äº‹ä»¶ç›‘å¬ç¤ºä¾‹

```go
// ç›‘å¬æ’ä»¶äº‹ä»¶
manager.SubscribeEvent(plugin.EventPluginStarted, func(event *plugin.Event) error {
    log.Printf("æ’ä»¶å¯åŠ¨: %s", event.Source)
    return nil
})

// ç›‘å¬ä»»åŠ¡äº‹ä»¶
manager.SubscribeEvent("scheduler.task.completed", func(event *plugin.Event) error {
    if taskEvent, ok := event.Data.(*plugin.TaskEvent); ok {
        log.Printf("ä»»åŠ¡å®Œæˆ: %s", taskEvent.TaskName)
    }
    return nil
})
```

### é›†æˆç°æœ‰æœåŠ¡

```go
// Redisé›†ç¾¤æ’ä»¶
redisPlugin := plugin.NewRedisClusterPlugin()
config := plugin.NewConfigBuilder().
    Set("addrs", []string{"localhost:7000", "localhost:7001"}).
    SetInt("pool_size", 10).
    Build()

manager.GetRegistry().Register(redisPlugin)
manager.InitializePlugin("redis-cluster", config)
manager.StartPlugin("redis-cluster")

// è·å–Rediså®¢æˆ·ç«¯
redisClient := redisPlugin.GetClient()
```

## ğŸ“¦ éƒ¨ç½²æŒ‡å—

### Dockeréƒ¨ç½²

```dockerfile
FROM golang:1.23-alpine AS builder

WORKDIR /app
COPY . .
RUN go mod download
RUN go build -o plugin-demo examples/plugin_demo/main.go

FROM alpine:latest
RUN apk --no-cache add ca-certificates
WORKDIR /root/
COPY --from=builder /app/plugin-demo .
EXPOSE 8080
CMD ["./plugin-demo"]
```

### Docker Compose

```yaml
version: '3.8'
services:
  plugin-framework:
    build: .
    ports:
      - "8080:8080"
    environment:
      - GO_ENV=production
    depends_on:
      - redis
      - kafka
      - etcd
  
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
  
  kafka:
    image: confluentinc/cp-kafka:latest
    ports:
      - "9092:9092"
    environment:
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://localhost:9092
  
  etcd:
    image: quay.io/coreos/etcd:latest
    ports:
      - "2379:2379"
```

### Kuberneteséƒ¨ç½²

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: plugin-framework
spec:
  replicas: 3
  selector:
    matchLabels:
      app: plugin-framework
  template:
    metadata:
      labels:
        app: plugin-framework
    spec:
      containers:
      - name: plugin-framework
        image: your-registry/plugin-framework:latest
        ports:
        - containerPort: 8080
        env:
        - name: GO_ENV
          value: "production"
---
apiVersion: v1
kind: Service
metadata:
  name: plugin-framework-service
spec:
  selector:
    app: plugin-framework
  ports:
  - protocol: TCP
    port: 80
    targetPort: 8080
  type: LoadBalancer
```

## ğŸ”§ é…ç½®è¯´æ˜

### æ’ä»¶ç®¡ç†å™¨é…ç½®

```go
config := &plugin.ManagerConfig{
    EnableAutoLoad:        true,                    // å¯ç”¨è‡ªåŠ¨åŠ è½½
    AutoLoadDirectory:     "./plugins",             // æ’ä»¶ç›®å½•
    EnableHotSwap:         true,                    // å¯ç”¨çƒ­æ’æ‹”
    HealthCheckInterval:   30 * time.Second,        // å¥åº·æ£€æŸ¥é—´éš”
    EnableDependencyCheck: true,                    // å¯ç”¨ä¾èµ–æ£€æŸ¥
    MaxStartupTime:        60 * time.Second,        // æœ€å¤§å¯åŠ¨æ—¶é—´
    EnableMetrics:         true,                    // å¯ç”¨æŒ‡æ ‡æ”¶é›†
}
```

### ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `GO_ENV` | è¿è¡Œç¯å¢ƒ | `development` |
| `HTTP_PORT` | HTTPæœåŠ¡ç«¯å£ | `8080` |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | `info` |
| `REDIS_ADDR` | Redisåœ°å€ | `localhost:6379` |
| `KAFKA_BROKERS` | Kafkaåœ°å€ | `localhost:9092` |
| `ETCD_ENDPOINTS` | Etcdåœ°å€ | `localhost:2379` |

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./...

# è¿è¡Œç‰¹å®šæµ‹è¯•
go test ./framework/plugin/...

# è¿è¡ŒåŸºå‡†æµ‹è¯•
go test -bench=. ./framework/plugin/...

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
go test -cover ./...
```

## ğŸ“ˆ æ€§èƒ½ç›‘æ§

æ¡†æ¶é›†æˆäº†Prometheusç›‘æ§æŒ‡æ ‡ï¼š

```go
// æ’ä»¶æŒ‡æ ‡
plugin_count_total                    // æ’ä»¶æ€»æ•°
plugin_status{name,status}           // æ’ä»¶çŠ¶æ€
plugin_startup_duration_seconds      // æ’ä»¶å¯åŠ¨æ—¶é—´

// ä»»åŠ¡è°ƒåº¦æŒ‡æ ‡  
scheduler_tasks_total                // ä»»åŠ¡æ€»æ•°
scheduler_task_executions_total      // ä»»åŠ¡æ‰§è¡Œæ¬¡æ•°
scheduler_task_duration_seconds      // ä»»åŠ¡æ‰§è¡Œæ—¶é—´
scheduler_task_failures_total        // ä»»åŠ¡å¤±è´¥æ¬¡æ•°
```

è®¿é—® http://localhost:8080/metrics æŸ¥çœ‹ç›‘æ§æŒ‡æ ‡ã€‚

## ğŸ” å®‰å…¨è€ƒè™‘

- **æ’ä»¶éš”ç¦»**: æ’ä»¶è¿è¡Œåœ¨ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡ä¸­
- **æƒé™æ§åˆ¶**: æ’ä»¶æƒé™ç®¡ç†å’Œè®¿é—®æ§åˆ¶
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥å‚æ•°éªŒè¯
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶

## ğŸ—ºï¸ è·¯çº¿å›¾

- [ ] **v2.0.0**
  - [ ] æ’ä»¶çƒ­åŠ è½½å’ŒåŠ¨æ€æ›´æ–°
  - [ ] å›¾å½¢åŒ–ç®¡ç†ç•Œé¢
  - [ ] æ›´å¤šCronè¡¨è¾¾å¼æ”¯æŒ
  - [ ] æ’ä»¶å¸‚åœºå’Œåˆ†å‘æœºåˆ¶

- [ ] **v2.1.0**
  - [ ] åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦
  - [ ] ä»»åŠ¡ä¾èµ–ç®¡ç†
  - [ ] æ›´å¼ºçš„æ’ä»¶éš”ç¦»
  - [ ] æ€§èƒ½ä¼˜åŒ–

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼

1. **Fork** é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ **Pull Request**

### å¼€å‘æŒ‡å—

- éµå¾ª [Go Code Review Comments](https://github.com/golang/go/wiki/CodeReviewComments)
- ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°æ–‡æ¡£
- è¿è¡Œ `go fmt` å’Œ `go vet`

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [Gin](https://github.com/gin-gonic/gin) - HTTP Webæ¡†æ¶
- [Go-Redis](https://github.com/go-redis/redis) - Rediså®¢æˆ·ç«¯
- [Sarama](https://github.com/Shopify/sarama) - Kafkaå®¢æˆ·ç«¯  
- [Etcd](https://github.com/etcd-io/etcd) - åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨
- [Prometheus](https://prometheus.io/) - ç›‘æ§ç³»ç»Ÿ
- [OpenTelemetry](https://opentelemetry.io/) - å¯è§‚æµ‹æ€§æ¡†æ¶

## ğŸ“ è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/your-org/distributed-service
- **é—®é¢˜åé¦ˆ**: https://github.com/your-org/distributed-service/issues
- **è®¨è®ºåŒº**: https://github.com/your-org/distributed-service/discussions

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼ 