# ğŸš€ åˆ†å¸ƒå¼æœåŠ¡æ’ä»¶åŒ–æ¡†æ¶

[![Go Version](https://img.shields.io/badge/Go-1.23+-brightgreen.svg)](https://golang.org)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Build Status](https://img.shields.io/badge/Build-Passing-brightgreen.svg)]()

ä¸€ä¸ªç°ä»£åŒ–çš„**åˆ†å¸ƒå¼æœåŠ¡æ’ä»¶åŒ–æ¡†æ¶**ï¼Œæ”¯æŒåŠ¨æ€æ’ä»¶ç®¡ç†ã€äº‹ä»¶é©±åŠ¨é€šä¿¡ã€å®šæ—¶ä»»åŠ¡è°ƒåº¦å’Œå¾®æœåŠ¡æ¶æ„ã€‚æ¡†æ¶å°†ä¼ ç»Ÿçš„å•ä½“æœåŠ¡è½¬æ¢ä¸ºé«˜åº¦æ¨¡å—åŒ–çš„æ’ä»¶ç³»ç»Ÿï¼Œæä¾›å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›å’Œçµæ´»çš„éƒ¨ç½²æ–¹æ¡ˆã€‚

## ğŸ“‹ ç›®å½•

- [æ ¸å¿ƒç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§)
- [æ¶æ„è®¾è®¡](#-æ¶æ„è®¾è®¡)
- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [æ’ä»¶ç³»ç»Ÿ](#-æ’ä»¶ç³»ç»Ÿ)
- [å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨](#-å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨)
- [APIæ–‡æ¡£](#-apiæ–‡æ¡£)
- [ä½¿ç”¨ç¤ºä¾‹](#-ä½¿ç”¨ç¤ºä¾‹)
- [éƒ¨ç½²æŒ‡å—](#-éƒ¨ç½²æŒ‡å—)
- [è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ§© æ’ä»¶åŒ–æ¶æ„
- **åŠ¨æ€æ’ä»¶ç®¡ç†**: è¿è¡Œæ—¶åŠ è½½ã€å¸è½½ã€é‡å¯æ’ä»¶
- **ä¾èµ–è§£æ**: è‡ªåŠ¨å¤„ç†æ’ä»¶ä¾èµ–å…³ç³»å’Œå¯åŠ¨é¡ºåº
- **ç”Ÿå‘½å‘¨æœŸç®¡ç†**: å®Œæ•´çš„æ’ä»¶ç”Ÿå‘½å‘¨æœŸæ§åˆ¶
- **æ¥å£æŠ½è±¡**: ç»Ÿä¸€çš„æ’ä»¶æ¥å£è®¾è®¡

### ğŸ“¡ äº‹ä»¶é©±åŠ¨é€šä¿¡
- **å¼‚æ­¥äº‹ä»¶æ€»çº¿**: æ’ä»¶é—´æ¾è€¦åˆé€šä¿¡
- **äº‹ä»¶è®¢é˜…å‘å¸ƒ**: æ”¯æŒå¤šç§äº‹ä»¶ç±»å‹å’Œå¤„ç†å™¨
- **å®æ—¶é€šçŸ¥**: æ’ä»¶çŠ¶æ€å˜åŒ–å®æ—¶æ¨é€

### â° å®šæ—¶ä»»åŠ¡è°ƒåº¦
- **å¤šç§è°ƒåº¦æ–¹å¼**: Cronè¡¨è¾¾å¼ã€é—´éš”æ—¶é—´ã€ä¸€æ¬¡æ€§ä»»åŠ¡
- **ä»»åŠ¡çŠ¶æ€ç®¡ç†**: è¿è¡Œã€æš‚åœã€æ¢å¤ã€å–æ¶ˆç­‰æ“ä½œ
- **æ‰§è¡Œç»Ÿè®¡**: è¿è¡Œæ¬¡æ•°ã€å¤±è´¥æ¬¡æ•°ã€æ€§èƒ½ç›‘æ§
- **äº‹ä»¶é›†æˆ**: ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€é€šè¿‡äº‹ä»¶ç³»ç»Ÿé€šçŸ¥

### ğŸŒ HTTPç®¡ç†æ¥å£
- **RESTful API**: å®Œæ•´çš„æ’ä»¶å’Œä»»åŠ¡ç®¡ç†æ¥å£
- **å®æ—¶ç›‘æ§**: æ’ä»¶çŠ¶æ€ã€ä»»åŠ¡æ‰§è¡Œæƒ…å†µæŸ¥è¯¢
- **Webæ§åˆ¶å°**: å‹å¥½çš„ç®¡ç†ç•Œé¢

### ğŸ”§ æœåŠ¡ç»„ä»¶é›†æˆ
- **Redis Cluster**: åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡
- **Apache Kafka**: æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡
- **Etcd**: é…ç½®ä¸­å¿ƒå’ŒæœåŠ¡å‘ç°
- **ç›‘æ§æŒ‡æ ‡**: Prometheusé›†æˆ
- **é“¾è·¯è¿½è¸ª**: OpenTelemetryæ”¯æŒ

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ’ä»¶åŒ–æœåŠ¡æ¡†æ¶                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  HTTP API     â”‚  äº‹ä»¶æ€»çº¿     â”‚  ä»»åŠ¡è°ƒåº¦å™¨    â”‚  æ’ä»¶ç®¡ç†å™¨    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        æ’ä»¶æ³¨å†Œè¡¨                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Redis        â”‚  Kafka       â”‚  Etcd        â”‚  è‡ªå®šä¹‰æ’ä»¶     â”‚
â”‚  æ’ä»¶          â”‚  æ’ä»¶         â”‚  æ’ä»¶         â”‚               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  HTTPä¼ è¾“      â”‚  gRPCä¼ è¾“     â”‚  WebSocket   â”‚  æ¶ˆæ¯é˜Ÿåˆ—      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           è®¤è¯æˆæƒ  â”‚  é™æµä¿æŠ¤  â”‚  ç›‘æ§æŒ‡æ ‡  â”‚  é“¾è·¯è¿½è¸ª          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | åŠŸèƒ½ | æè¿° |
|------|------|------|
| **Plugin Manager** | æ’ä»¶ç®¡ç† | æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€ä¾èµ–è§£æ |
| **Event Bus** | äº‹ä»¶é€šä¿¡ | å¼‚æ­¥äº‹ä»¶å‘å¸ƒè®¢é˜…æœºåˆ¶ |
| **Task Scheduler** | ä»»åŠ¡è°ƒåº¦ | Cron/é—´éš”/ä¸€æ¬¡æ€§ä»»åŠ¡è°ƒåº¦ |
| **Plugin Registry** | æ’ä»¶æ³¨å†Œ | æ’ä»¶æ³¨å†Œè¡¨å’ŒæœåŠ¡å‘ç° |
| **Config Provider** | é…ç½®ç®¡ç† | æ’ä»¶é…ç½®ç®¡ç†å’Œçƒ­æ›´æ–° |
| **Plugin Factory** | æ’ä»¶å·¥å‚ | åŠ¨æ€åˆ›å»ºæ’ä»¶å®ä¾‹ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.23+
- Redis (å¯é€‰)
- Kafka (å¯é€‰)
- Etcd (å¯é€‰)

### å®‰è£…è¿è¡Œ

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/qiaojinxia/distributed-service
cd distributed-service

# 2. å®‰è£…ä¾èµ–
go mod download

# 3. è¿è¡Œæ¼”ç¤ºç¨‹åº
cd examples/plugin_demo
go build -v
./plugin_demo
```

### è®¿é—®æœåŠ¡

å¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥è®¿é—®ä»¥ä¸‹åœ°å€ï¼š

- **ä¸»é¡µ**: http://localhost:8080/demo
- **æ’ä»¶ç®¡ç†**: http://localhost:8080/plugins/status
- **ä»»åŠ¡è°ƒåº¦**: http://localhost:8080/scheduler/tasks
- **ä»»åŠ¡æ¼”ç¤º**: http://localhost:8080/demo/scheduler

## ğŸ“– æ¡†æ¶åŸºç¡€ä½¿ç”¨

æœ¬æ¡†æ¶æä¾›äº†å®Œæ•´çš„åˆ†å¸ƒå¼æœåŠ¡åŸºç¡€è®¾æ–½ï¼Œæ”¯æŒHTTP REST APIã€gRPCæœåŠ¡ã€ç»Ÿä¸€æ—¥å¿—è®°å½•ã€é…ç½®ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

### ğŸš€ æœ€ç®€å•çš„å¼€å§‹

```go
package main

import (
    "github.com/qiaojinxia/distributed-service/framework"
)

func main() {
    // é›¶é…ç½®å¯åŠ¨ - è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒé…ç½®
    framework.Start()
}
```

### ğŸŒ HTTPæœåŠ¡

#### åŸºç¡€HTTPæœåŠ¡

```go
package main

import (
    "context"
    "github.com/gin-gonic/gin"
    "github.com/qiaojinxia/distributed-service/framework"
    "github.com/qiaojinxia/distributed-service/framework/logger"
)

func main() {
    err := framework.New().
        Port(8080).                    // è®¾ç½®ç«¯å£
        Name("my-api-service").        // æœåŠ¡åç§°
        Version("v1.0.0").            // ç‰ˆæœ¬å·
        Mode("debug").                // è¿è¡Œæ¨¡å¼ (debug/release/test)
        OnlyHTTP().                   // åªå¯ç”¨HTTPæœåŠ¡
        HTTP(setupRoutes).            // æ³¨å†Œè·¯ç”±
        BeforeStart(func(ctx context.Context) error {
            logger.GetLogger().Info("ğŸ”§ æœåŠ¡åˆå§‹åŒ–ä¸­...")
            return nil
        }).
        AfterStart(func(ctx context.Context) error {
            logger.GetLogger().Info("âœ… HTTPæœåŠ¡å¯åŠ¨å®Œæˆ!")
            logger.GetLogger().Info("ğŸŒ è®¿é—®åœ°å€: http://localhost:8080")
            return nil
        }).
        Run()
    
    if err != nil {
        logger.GetLogger().Fatal("æœåŠ¡å¯åŠ¨å¤±è´¥", logger.Any("error", err))
    }
}

// è®¾ç½®è·¯ç”±
func setupRoutes(r interface{}) {
    router := r.(*gin.Engine)
    
    // å¥åº·æ£€æŸ¥
    router.GET("/health", func(c *gin.Context) {
        c.JSON(200, gin.H{
            "status": "ok",
            "service": "my-api-service",
            "version": "v1.0.0",
        })
    })
    
    // APIè·¯ç”±ç»„
    api := router.Group("/api/v1")
    {
        api.GET("/users", getUserList)
        api.GET("/users/:id", getUserByID)
        api.POST("/users", createUser)
        api.PUT("/users/:id", updateUser)
        api.DELETE("/users/:id", deleteUser)
    }
}

func getUserList(c *gin.Context) {
    c.JSON(200, gin.H{
        "users": []gin.H{
            {"id": 1, "name": "Alice", "email": "alice@example.com"},
            {"id": 2, "name": "Bob", "email": "bob@example.com"},
        },
        "total": 2,
    })
}

func getUserByID(c *gin.Context) {
    id := c.Param("id")
    c.JSON(200, gin.H{
        "id": id,
        "name": "User " + id,
        "email": "user" + id + "@example.com",
    })
}

func createUser(c *gin.Context) {
    // å¤„ç†ç”¨æˆ·åˆ›å»ºé€»è¾‘
    c.JSON(201, gin.H{"message": "User created successfully"})
}

func updateUser(c *gin.Context) {
    // å¤„ç†ç”¨æˆ·æ›´æ–°é€»è¾‘
    id := c.Param("id")
    c.JSON(200, gin.H{"message": "User " + id + " updated successfully"})
}

func deleteUser(c *gin.Context) {
    // å¤„ç†ç”¨æˆ·åˆ é™¤é€»è¾‘
    id := c.Param("id")
    c.JSON(200, gin.H{"message": "User " + id + " deleted successfully"})
}
```

#### å¿«é€ŸWebæœåŠ¡

```go
// ä½¿ç”¨ä¾¿æ·æ–¹æ³•å¯åŠ¨WebæœåŠ¡
framework.Web(8080, func(r *gin.Engine) {
    r.GET("/", func(c *gin.Context) {
        c.JSON(200, gin.H{"message": "Hello World!"})
    })
    
    r.GET("/api/status", func(c *gin.Context) {
        c.JSON(200, gin.H{"status": "running"})
    })
})
```

### ğŸ”Œ gRPCæœåŠ¡

#### åŸºç¡€gRPCæœåŠ¡

```go
package main

import (
    "context"
    "github.com/qiaojinxia/distributed-service/framework"
    "github.com/qiaojinxia/distributed-service/framework/logger"
    "google.golang.org/grpc"
)

func main() {
    err := framework.New().
        Port(8080).                     // HTTPç«¯å£ (ç”¨äºå¥åº·æ£€æŸ¥ç­‰)
        Name("my-grpc-service").        // æœåŠ¡åç§°
        Version("v1.0.0").             // ç‰ˆæœ¬å·
        Mode("debug").                 // è¿è¡Œæ¨¡å¼
        OnlyGRPC().                    // åªå¯ç”¨gRPCæœåŠ¡
        GRPC(setupGRPCServices).       // æ³¨å†ŒgRPCæœåŠ¡
        BeforeStart(func(ctx context.Context) error {
            logger.GetLogger().Info("ğŸ”§ gRPCæœåŠ¡åˆå§‹åŒ–ä¸­...")
            return nil
        }).
        AfterStart(func(ctx context.Context) error {
            logger.GetLogger().Info("âœ… gRPCæœåŠ¡å¯åŠ¨å®Œæˆ!")
            logger.GetLogger().Info("ğŸ”Œ gRPCç›‘å¬åœ°å€: localhost:9093")
            return nil
        }).
        Run()
    
    if err != nil {
        logger.GetLogger().Fatal("gRPCæœåŠ¡å¯åŠ¨å¤±è´¥", logger.Any("error", err))
    }
}

// è®¾ç½®gRPCæœåŠ¡
func setupGRPCServices(s interface{}) {
    server := s.(*grpc.Server)
    
    // æ³¨å†Œè‡ªå®šä¹‰gRPCæœåŠ¡
    // pb.RegisterUserServiceServer(server, &userService{})
    // pb.RegisterOrderServiceServer(server, &orderService{})
    
    logger.GetLogger().Info("ğŸ”Œ gRPCæœåŠ¡æ³¨å†Œå®Œæˆ")
    logger.GetLogger().Info("  âœ… HealthCheckæœåŠ¡ (è‡ªåŠ¨æ³¨å†Œ)")
    logger.GetLogger().Info("  âœ… Server Reflection (è‡ªåŠ¨æ³¨å†Œ)")
}
```

#### å¿«é€Ÿå¾®æœåŠ¡

```go
// ä½¿ç”¨ä¾¿æ·æ–¹æ³•å¯åŠ¨å¾®æœåŠ¡
framework.Micro(9000, func(s *grpc.Server) {
    // æ³¨å†Œä½ çš„gRPCæœåŠ¡
    // pb.RegisterMyServiceServer(s, &myServiceImpl{})
    
    log.Println("ğŸ”Œ å¾®æœåŠ¡æ³¨å†Œå®Œæˆ")
})
```

### ğŸ”„ HTTP + gRPC åŒæœåŠ¡

```go
package main

import (
    "context"
    "github.com/gin-gonic/gin"
    "github.com/qiaojinxia/distributed-service/framework"
    "github.com/qiaojinxia/distributed-service/framework/logger"
    "google.golang.org/grpc"
)

func main() {
    err := framework.New().
        Port(8080).                     // HTTPç«¯å£
        Name("full-service").           // æœåŠ¡åç§°
        Version("v1.0.0").             // ç‰ˆæœ¬å·
        Mode("debug").                 // è¿è¡Œæ¨¡å¼
        EnableAll().                   // å¯ç”¨æ‰€æœ‰æœåŠ¡ (HTTP + gRPC + Metrics + Tracing)
        HTTP(setupHTTPRoutes).         // æ³¨å†ŒHTTPè·¯ç”±
        GRPC(setupGRPCServices).       // æ³¨å†ŒgRPCæœåŠ¡
        BeforeStart(func(ctx context.Context) error {
            logger.GetLogger().Info("ğŸ”§ åˆå§‹åŒ–å®Œæ•´æœåŠ¡...")
            return nil
        }).
        AfterStart(func(ctx context.Context) error {
            log := logger.GetLogger()
            log.Info("âœ… å®Œæ•´æœåŠ¡å¯åŠ¨å®Œæˆ!")
            log.Info("ğŸŒ HTTPæœåŠ¡: http://localhost:8080")
            log.Info("ğŸ”Œ gRPCæœåŠ¡: localhost:9093")
            log.Info("ğŸ“Š å¥åº·æ£€æŸ¥: http://localhost:8080/health")
            log.Info("ğŸ“ˆ ç›‘æ§æŒ‡æ ‡: http://localhost:9092/metrics")
            return nil
        }).
        Run()
    
    if err != nil {
        logger.GetLogger().Fatal("å®Œæ•´æœåŠ¡å¯åŠ¨å¤±è´¥", logger.Any("error", err))
    }
}

func setupHTTPRoutes(r interface{}) {
    router := r.(*gin.Engine)
    
    // å¥åº·æ£€æŸ¥
    router.GET("/health", func(c *gin.Context) {
        c.JSON(200, gin.H{
            "status": "ok",
            "services": gin.H{
                "http": "running",
                "grpc": "running",
            },
        })
    })
    
    // REST API
    api := router.Group("/api/v1")
    {
        api.GET("/users", func(c *gin.Context) {
            // å¯ä»¥è°ƒç”¨gRPCæœåŠ¡è·å–æ•°æ®
            c.JSON(200, gin.H{"users": []string{"alice", "bob"}})
        })
    }
}

func setupGRPCServices(s interface{}) {
    server := s.(*grpc.Server)
    
    // æ³¨å†Œä¸šåŠ¡gRPCæœåŠ¡
    // pb.RegisterUserServiceServer(server, &userServiceImpl{})
    
    logger.GetLogger().Info("ğŸ”Œ gRPCæœåŠ¡æ³¨å†Œå®Œæˆ")
}
```

### ğŸ“‹ ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ

æ¡†æ¶æä¾›äº†ç»Ÿä¸€çš„ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿï¼Œè‡ªåŠ¨åŒ…å«æ—¶é—´æˆ³ã€æ—¥å¿—çº§åˆ«ã€æ¥æºä¿¡æ¯ç­‰ã€‚

#### åŸºç¡€æ—¥å¿—ä½¿ç”¨

```go
package main

import (
    "github.com/qiaojinxia/distributed-service/framework/logger"
)

func main() {
    // è·å–å…¨å±€loggerå®ä¾‹
    log := logger.GetLogger()
    
    // åŸºç¡€æ—¥å¿—è®°å½•
    log.Info("åº”ç”¨ç¨‹åºå¯åŠ¨")
    log.Warn("è¿™æ˜¯ä¸€ä¸ªè­¦å‘Šæ¶ˆæ¯")
    log.Error("å‘ç”Ÿäº†é”™è¯¯")
    
    // ç»“æ„åŒ–æ—¥å¿— - æ¨èæ–¹å¼
    log.Info("ç”¨æˆ·ç™»å½•", 
        logger.String("user_id", "12345"),
        logger.String("ip", "192.168.1.1"),
        logger.Int("attempts", 3))
    
    // é”™è¯¯æ—¥å¿—
    err := errors.New("æ•°æ®åº“è¿æ¥å¤±è´¥")
    log.Error("æ•°æ®åº“æ“ä½œå¤±è´¥", 
        logger.Any("error", err),
        logger.String("operation", "user_query"),
        logger.Duration("timeout", 5*time.Second))
    
    // è‡´å‘½é”™è¯¯ï¼ˆä¼šé€€å‡ºç¨‹åºï¼‰
    log.Fatal("æ— æ³•å¯åŠ¨æœåŠ¡", logger.Any("error", err))
}
```

#### æ—¥å¿—çº§åˆ«

```go
// æ”¯æŒçš„æ—¥å¿—çº§åˆ«
log.Debug("è°ƒè¯•ä¿¡æ¯")    // å¼€å‘ç¯å¢ƒè¯¦ç»†ä¿¡æ¯
log.Info("ä¿¡æ¯æ—¥å¿—")     // ä¸€èˆ¬ä¿¡æ¯
log.Warn("è­¦å‘Šæ—¥å¿—")     // è­¦å‘Šä¿¡æ¯
log.Error("é”™è¯¯æ—¥å¿—")    // é”™è¯¯ä¿¡æ¯
log.Fatal("è‡´å‘½é”™è¯¯")    // è‡´å‘½é”™è¯¯ï¼Œç¨‹åºé€€å‡º
```

#### ä¸Šä¸‹æ–‡æ—¥å¿—

```go
import (
    "context"
    "github.com/qiaojinxia/distributed-service/framework/logger"
)

func businessHandler(ctx context.Context) {
    // ä»ä¸Šä¸‹æ–‡è·å–logger
    log := logger.GetLogger()
    
    // å¸¦ä¸Šä¸‹æ–‡çš„æ—¥å¿—è®°å½•
    log.Info("å¤„ç†ä¸šåŠ¡è¯·æ±‚", 
        logger.String("request_id", "req-123"),
        logger.String("user_id", "user-456"))
    
    // åœ¨å‡½æ•°ä¸­ä¼ é€’context
    processOrder(ctx, "order-789")
}

func processOrder(ctx context.Context, orderID string) {
    log := logger.GetLogger()
    
    log.Info("å¼€å§‹å¤„ç†è®¢å•", 
        logger.String("order_id", orderID))
    
    // ä¸šåŠ¡é€»è¾‘...
    
    log.Info("è®¢å•å¤„ç†å®Œæˆ", 
        logger.String("order_id", orderID),
        logger.String("status", "completed"))
}
```

### âš™ï¸ é…ç½®æ–‡ä»¶ä½¿ç”¨

æ¡†æ¶æ”¯æŒYAMLæ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œæä¾›ä¸°å¯Œçš„é…ç½®é€‰é¡¹ã€‚

#### åŸºç¡€é…ç½®æ–‡ä»¶ (`config/config.yaml`)

```yaml
# æœåŠ¡é…ç½®
server:
  port: 8080                        # HTTPç«¯å£
  mode: debug                       # è¿è¡Œæ¨¡å¼: debug/release/test
  name: my-service                  # æœåŠ¡åç§°
  version: v1.0.0                   # æœåŠ¡ç‰ˆæœ¬
  tags: "api,microservice"          # æœåŠ¡æ ‡ç­¾

# gRPCé…ç½®  
grpc:
  port: 9093                        # gRPCç«¯å£
  max_recv_msg_size: 4194304        # æœ€å¤§æ¥æ”¶æ¶ˆæ¯å¤§å° (4MB)
  max_send_msg_size: 4194304        # æœ€å¤§å‘é€æ¶ˆæ¯å¤§å° (4MB)
  connection_timeout: "5s"          # è¿æ¥è¶…æ—¶
  enable_reflection: true           # å¯ç”¨åå°„æœåŠ¡
  enable_health_check: true         # å¯ç”¨å¥åº·æ£€æŸ¥

# æ—¥å¿—é…ç½®
logger:
  level: debug                      # æ—¥å¿—çº§åˆ«: debug/info/warn/error
  encoding: console                 # ç¼–ç æ ¼å¼: console/json
  output_path: stdout               # è¾“å‡ºè·¯å¾„: stdout/æ–‡ä»¶è·¯å¾„

# JWTè®¤è¯é…ç½®
jwt:
  secret_key: "your-secret-key"     # JWTå¯†é’¥
  issuer: "my-service"              # å‘è¡Œè€…

# MySQLæ•°æ®åº“é…ç½®
mysql:
  host: localhost
  port: 3306
  username: root
  password: root
  database: my_database
  charset: utf8mb4
  max_idle_conns: 10               # æœ€å¤§ç©ºé—²è¿æ¥æ•°
  max_open_conns: 100              # æœ€å¤§æ‰“å¼€è¿æ¥æ•°

# Redisé…ç½®
redis:
  host: localhost
  port: 6379
  password: ""                     # Rediså¯†ç 
  db: 0                           # æ•°æ®åº“ç¼–å·
  pool_size: 100                  # è¿æ¥æ± å¤§å°

# ç›‘æ§æŒ‡æ ‡é…ç½®
metrics:
  enabled: true                    # å¯ç”¨ç›‘æ§
  prometheus_port: 9092           # Prometheusç«¯å£

# é“¾è·¯è¿½è¸ªé…ç½®
tracing:
  service_name: my-service        # æœåŠ¡åç§°
  service_version: v1.0.0         # æœåŠ¡ç‰ˆæœ¬
  environment: development        # ç¯å¢ƒ
  enabled: true                   # å¯ç”¨è¿½è¸ª
  exporter_type: stdout           # å¯¼å‡ºå™¨ç±»å‹: stdout/otlp
  sample_ratio: 1.0               # é‡‡æ ·æ¯”ä¾‹ (0.0-1.0)
```

#### ä½¿ç”¨é…ç½®æ–‡ä»¶

```go
package main

import (
    "github.com/qiaojinxia/distributed-service/framework"
)

func main() {
    err := framework.New().
        Config("config/config.yaml").   // æŒ‡å®šé…ç½®æ–‡ä»¶
        AutoDetect().                   // è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå˜é‡
        HTTP(setupRoutes).
        Run()
    
    if err != nil {
        log.Fatal(err)
    }
}
```

#### ç¯å¢ƒå˜é‡é…ç½®

```bash
# é€šè¿‡ç¯å¢ƒå˜é‡è¦†ç›–é…ç½®
export PORT=8080
export GIN_MODE=release
export CONFIG_PATH=config/production.yaml
export APP_NAME=my-production-service

# å¯åŠ¨åº”ç”¨
./my-service
```

### ğŸ”§ ç»„ä»¶é…ç½®é€‰é¡¹

#### é€‰æ‹©æ€§å¯ç”¨ç»„ä»¶

```go
// æœ€å°åŒ–é…ç½® - åªå¯ç”¨å¿…è¦ç»„ä»¶
framework.New().
    Port(8080).
    OnlyHTTP().                    // åªå¯ç”¨HTTP
    DisableComponents("metrics", "tracing").  // ç¦ç”¨æŒ‡å®šç»„ä»¶
    HTTP(setupRoutes).
    Run()

// è‡ªå®šä¹‰ç»„ä»¶é…ç½®
framework.New().
    Port(8080).
    Enable("http", "metrics").     // åªå¯ç”¨HTTPå’Œç›‘æ§
    Disable("grpc", "tracing").    // ç¦ç”¨gRPCå’Œè¿½è¸ª
    HTTP(setupRoutes).
    Run()

// å®Œæ•´åŠŸèƒ½
framework.New().
    Port(8080).
    EnableAll().                   // å¯ç”¨æ‰€æœ‰ç»„ä»¶
    HTTP(setupRoutes).
    GRPC(setupGRPCServices).
    Run()
```

#### å¼€å‘æ¨¡å¼å¿«æ·é…ç½®

```go
// å¼€å‘æ¨¡å¼
framework.New().
    Dev().                         // 8080ç«¯å£ï¼Œdebugæ¨¡å¼
    HTTP(setupRoutes).
    Run()

// ç”Ÿäº§æ¨¡å¼  
framework.New().
    Prod().                        // 80ç«¯å£ï¼Œreleaseæ¨¡å¼
    HTTP(setupRoutes).
    Run()

// æµ‹è¯•æ¨¡å¼
framework.New().
    Test().                        // éšæœºç«¯å£ï¼Œtestæ¨¡å¼ï¼Œåªå¯ç”¨HTTP
    HTTP(setupRoutes).
    Run()
```

### ğŸ› ï¸ ç”Ÿå‘½å‘¨æœŸé’©å­

æ¡†æ¶æä¾›äº†å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œæ–¹ä¾¿åœ¨ä¸åŒé˜¶æ®µæ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ã€‚

```go
err := framework.New().
    Port(8080).
    // å¯åŠ¨å‰å›è°ƒ
    BeforeStart(func(ctx context.Context) error {
        log.Info("ğŸ”§ æ‰§è¡Œå¯åŠ¨å‰åˆå§‹åŒ–...")
        // åˆå§‹åŒ–æ•°æ®åº“è¿æ¥
        // åŠ è½½é…ç½®æ–‡ä»¶
        // é¢„çƒ­ç¼“å­˜
        return nil
    }).
    // å¯åŠ¨åå›è°ƒ
    AfterStart(func(ctx context.Context) error {
        log.Info("âœ… æœåŠ¡å¯åŠ¨å®Œæˆ!")
        // æ³¨å†Œåˆ°æœåŠ¡å‘ç°
        // å¯åŠ¨åå°ä»»åŠ¡
        // å‘é€å¯åŠ¨é€šçŸ¥
        return nil
    }).
    // åœæ­¢å‰å›è°ƒ
    BeforeStop(func(ctx context.Context) error {
        log.Info("ğŸ›‘ æ‰§è¡Œåœæ­¢å‰æ¸…ç†...")
        // å®Œæˆæ­£åœ¨å¤„ç†çš„è¯·æ±‚
        // ä¿å­˜çŠ¶æ€æ•°æ®
        return nil
    }).
    // åœæ­¢åå›è°ƒ
    AfterStop(func(ctx context.Context) error {
        log.Info("âœ… æœåŠ¡å·²å®Œå…¨åœæ­¢")
        // æ¸…ç†èµ„æº
        // å‘é€åœæ­¢é€šçŸ¥
        return nil
    }).
    HTTP(setupRoutes).
    Run()
```

### ğŸ“Š å¥åº·æ£€æŸ¥å’Œç›‘æ§

æ¡†æ¶è‡ªåŠ¨æä¾›å¥åº·æ£€æŸ¥å’Œç›‘æ§ç«¯ç‚¹ï¼š

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/health

# å“åº”ç¤ºä¾‹
{
  "status": "ok",
  "service": "my-service",
  "version": "v1.0.0",
  "timestamp": "2024-01-20T10:00:00Z",
  "components": {
    "database": "healthy",
    "redis": "healthy",
    "grpc": "healthy"
  }
}

# Prometheusç›‘æ§æŒ‡æ ‡
curl http://localhost:9092/metrics
```

### ğŸ” æœ€ä½³å®è·µ

#### 1. é¡¹ç›®ç»“æ„å»ºè®®

```
my-service/
â”œâ”€â”€ main.go                 # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ config.yaml         # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ development.yaml    # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ production.yaml     # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ handler/            # HTTPå¤„ç†å™¨
â”‚   â”œâ”€â”€ service/            # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ repository/         # æ•°æ®è®¿é—®å±‚
â”‚   â””â”€â”€ model/              # æ•°æ®æ¨¡å‹
â”œâ”€â”€ proto/                  # gRPCåè®®æ–‡ä»¶
â”œâ”€â”€ scripts/                # éƒ¨ç½²è„šæœ¬
â””â”€â”€ docs/                   # æ–‡æ¡£
```

#### 2. é”™è¯¯å¤„ç†

```go
import (
    "errors"
    "github.com/qiaojinxia/distributed-service/framework/logger"
)

func businessLogic() error {
    log := logger.GetLogger()
    
    if err := doSomething(); err != nil {
        // è®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯
        log.Error("ä¸šåŠ¡å¤„ç†å¤±è´¥", 
            logger.Any("error", err),
            logger.String("operation", "user_create"),
            logger.String("user_id", "12345"))
        
        // è¿”å›ç”¨æˆ·å‹å¥½çš„é”™è¯¯
        return errors.New("ç”¨æˆ·åˆ›å»ºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")
    }
    
    log.Info("ä¸šåŠ¡å¤„ç†æˆåŠŸ")
    return nil
}
```

#### 3. æ€§èƒ½ä¼˜åŒ–

```go
// å¯ç”¨æ‰€æœ‰æ€§èƒ½ç›¸å…³ç»„ä»¶
framework.New().
    Port(8080).
    Mode("release").               // ç”Ÿäº§æ¨¡å¼
    EnableAll().                   // å¯ç”¨æ‰€æœ‰ç»„ä»¶
    WithMetrics(&metrics.Config{   // è‡ªå®šä¹‰ç›‘æ§é…ç½®
        Enabled: true,
        Port:    9092,
    }).
    WithTracing(&tracing.Config{   // è‡ªå®šä¹‰è¿½è¸ªé…ç½®
        SampleRatio: 0.1,          // 10%é‡‡æ ·ç‡
    }).
    HTTP(setupRoutes).
    Run()
```

è¿™ä¸ªæ¡†æ¶åŸºç¡€ä½¿ç”¨æŒ‡å—æ¶µç›–äº†ä»æœ€ç®€å•çš„å¯åŠ¨åˆ°å¤æ‚çš„åŒæœåŠ¡é…ç½®ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹å¹¶æ„å»ºç”Ÿäº§çº§çš„åˆ†å¸ƒå¼æœåŠ¡ã€‚

## ğŸ§© æ’ä»¶ç³»ç»Ÿ

### æ’ä»¶ç±»å‹

```go
// åŸºç¡€æ’ä»¶æ¥å£
type Plugin interface {
    Name() string
    Version() string
    Initialize(ctx context.Context, config Config) error
    Start(ctx context.Context) error
    Stop(ctx context.Context) error
    Status() Status
    Health() HealthStatus
}

// æœåŠ¡æ’ä»¶ - æä¾›å…·ä½“ä¸šåŠ¡æœåŠ¡
type ServicePlugin interface {
    Plugin
    GetService() interface{}
    GetEndpoints() []Endpoint
}

// ä¸­é—´ä»¶æ’ä»¶ - æä¾›ä¸­é—´ä»¶åŠŸèƒ½
type MiddlewarePlugin interface {
    Plugin
    GetMiddleware() interface{}
    Priority() int
}
```

### åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶

```go
// 1. ä½¿ç”¨æ„å»ºå™¨åˆ›å»ºæ’ä»¶
plugin := plugin.NewServicePluginBuilder("my-service", "v1.0.0", "è‡ªå®šä¹‰æœåŠ¡").
    Dependencies([]string{"logger", "config"}).
    Service(myService).
    Endpoint(plugin.Endpoint{
        Name: "health",
        Path: "/my-service/health",
        Method: "GET",
    }).
    OnInitialize(func(ctx context.Context, config plugin.Config) error {
        // åˆå§‹åŒ–é€»è¾‘
        return nil
    }).
    OnStart(func(ctx context.Context) error {
        // å¯åŠ¨é€»è¾‘
        return nil
    }).
    Build()

// 2. æ³¨å†Œæ’ä»¶
manager.GetRegistry().Register(plugin)

// 3. å¯åŠ¨æ’ä»¶
manager.StartPlugin("my-service")
```

### æ’ä»¶ç”Ÿå‘½å‘¨æœŸ

```mermaid
graph TD
    A[åˆ›å»ºæ’ä»¶] --> B[æ³¨å†Œæ’ä»¶]
    B --> C[åˆå§‹åŒ–]
    C --> D[å¯åŠ¨]
    D --> E[è¿è¡Œä¸­]
    E --> F[åœæ­¢]
    F --> G[é”€æ¯]
    
    E --> H[é‡å¯]
    H --> C
    
    C --> I[åˆå§‹åŒ–å¤±è´¥]
    D --> J[å¯åŠ¨å¤±è´¥]
    I --> K[å¤±è´¥çŠ¶æ€]
    J --> K
```

## â° å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨

### æ”¯æŒçš„è°ƒåº¦ç±»å‹

```go
// 1. Cronè¡¨è¾¾å¼è°ƒåº¦
task := plugin.NewTaskBuilder("cron-task", "å®šæ—¶ä»»åŠ¡").
    Cron("@every 1m").               // æ¯åˆ†é’Ÿæ‰§è¡Œ
    Handler(myTaskHandler).
    Build()

// 2. é—´éš”æ—¶é—´è°ƒåº¦
task := plugin.NewTaskBuilder("interval-task", "é—´éš”ä»»åŠ¡").
    Interval(30 * time.Second).      // æ¯30ç§’æ‰§è¡Œ
    MaxRuns(10).                     // æœ€å¤šæ‰§è¡Œ10æ¬¡
    Handler(myTaskHandler).
    Build()

// 3. ä¸€æ¬¡æ€§å»¶æ—¶ä»»åŠ¡
task := plugin.NewTaskBuilder("once-task", "ä¸€æ¬¡æ€§ä»»åŠ¡").
    Once(10 * time.Second).          // 10ç§’åæ‰§è¡Œä¸€æ¬¡
    Handler(myTaskHandler).
    Build()

// è°ƒåº¦ä»»åŠ¡
scheduler.ScheduleTask(task)
```

### ä»»åŠ¡çŠ¶æ€ç®¡ç†

| çŠ¶æ€ | æè¿° |
|------|------|
| `pending` | ç­‰å¾…æ‰§è¡Œ |
| `running` | æ­£åœ¨æ‰§è¡Œ |
| `paused` | å·²æš‚åœ |
| `completed` | å·²å®Œæˆ |
| `failed` | æ‰§è¡Œå¤±è´¥ |
| `canceled` | å·²å–æ¶ˆ |

### ä»»åŠ¡æ§åˆ¶

```go
// æš‚åœä»»åŠ¡
scheduler.PauseTask("task-id")

// æ¢å¤ä»»åŠ¡
scheduler.ResumeTask("task-id")

// å–æ¶ˆä»»åŠ¡
scheduler.CancelTask("task-id")

// æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
task := scheduler.GetTask("task-id")
fmt.Printf("ä»»åŠ¡çŠ¶æ€: %s, æ‰§è¡Œæ¬¡æ•°: %d", task.Status, task.RunCount)
```

## ğŸ“– APIæ–‡æ¡£

### æ’ä»¶ç®¡ç†API

```http
# è·å–æ‰€æœ‰æ’ä»¶çŠ¶æ€
GET /plugins/status

# é‡å¯æŒ‡å®šæ’ä»¶
POST /plugins/{name}/restart

# å‘å¸ƒæµ‹è¯•äº‹ä»¶
POST /plugins/events/test
```

### ä»»åŠ¡è°ƒåº¦API

```http
# è·å–æ‰€æœ‰ä»»åŠ¡
GET /scheduler/tasks

# åˆ›å»ºæ–°ä»»åŠ¡
POST /scheduler/tasks
Content-Type: application/json

{
  "id": "my-task",
  "name": "æˆ‘çš„ä»»åŠ¡",
  "description": "ä»»åŠ¡æè¿°",
  "schedule": {
    "type": "interval",
    "interval": "30s",
    "max_runs": 10
  }
}

# è·å–æŒ‡å®šä»»åŠ¡
GET /scheduler/tasks/{id}

# æš‚åœä»»åŠ¡
POST /scheduler/tasks/{id}/pause

# æ¢å¤ä»»åŠ¡  
POST /scheduler/tasks/{id}/resume

# å–æ¶ˆä»»åŠ¡
POST /scheduler/tasks/{id}/cancel

# è·å–è°ƒåº¦å™¨çŠ¶æ€
GET /scheduler/status
```

### å“åº”æ ¼å¼

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "task": {
      "id": "my-task",
      "name": "æˆ‘çš„ä»»åŠ¡",
      "status": "running",
      "run_count": 5,
      "created_at": "2024-01-01T10:00:00Z",
      "next_run_at": "2024-01-01T10:01:00Z"
    }
  }
}
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨

```go
package main

import (
    "github.com/qiaojinxia/distributed_service/framework/plugin"
    "time"
)

func main() {
    // 1. åˆ›å»ºæ’ä»¶ç®¡ç†å™¨
    manager := plugin.NewDefaultManager(&plugin.ManagerConfig{
        EnableDependencyCheck: true,
        HealthCheckInterval:   30 * time.Second,
    })
    
    // 2. è®¾ç½®æ—¥å¿—
    logger := plugin.NewSimplePluginLogger("demo")
    manager.SetLogger(logger)
    
    // 3. åˆ›å»ºå¹¶å¯åŠ¨è°ƒåº¦å™¨æ’ä»¶
    schedulerPlugin := plugin.NewSchedulerPlugin()
    manager.GetRegistry().Register(schedulerPlugin)
    manager.StartPlugin("scheduler")
    
    // 4. åˆ›å»ºå®šæ—¶ä»»åŠ¡
    task := plugin.NewTaskBuilder("log-task", "æ—¥å¿—ä»»åŠ¡").
        Cron("@every 1m").
        Handler(func(ctx context.Context, task *plugin.Task) error {
            log.Printf("å®šæ—¶ä»»åŠ¡æ‰§è¡Œ: %s", task.Name)
            return nil
        }).
        Build()
    
    // 5. è°ƒåº¦ä»»åŠ¡
    schedulerPlugin.ScheduleTask(task)
    
    // 6. å¯åŠ¨HTTPæœåŠ¡
    framework.Web(8080)
}
```

### äº‹ä»¶ç›‘å¬ç¤ºä¾‹

```go
// ç›‘å¬æ’ä»¶äº‹ä»¶
manager.SubscribeEvent(plugin.EventPluginStarted, func(event *plugin.Event) error {
    log.Printf("æ’ä»¶å¯åŠ¨: %s", event.Source)
    return nil
})

// ç›‘å¬ä»»åŠ¡äº‹ä»¶
manager.SubscribeEvent("scheduler.task.completed", func(event *plugin.Event) error {
    if taskEvent, ok := event.Data.(*plugin.TaskEvent); ok {
        log.Printf("ä»»åŠ¡å®Œæˆ: %s", taskEvent.TaskName)
    }
    return nil
})
```

### é›†æˆç°æœ‰æœåŠ¡

```go
// Redisé›†ç¾¤æ’ä»¶
redisPlugin := plugin.NewRedisClusterPlugin()
config := plugin.NewConfigBuilder().
    Set("addrs", []string{"localhost:7000", "localhost:7001"}).
    SetInt("pool_size", 10).
    Build()

manager.GetRegistry().Register(redisPlugin)
manager.InitializePlugin("redis-cluster", config)
manager.StartPlugin("redis-cluster")

// è·å–Rediså®¢æˆ·ç«¯
redisClient := redisPlugin.GetClient()
```

## ğŸ“¦ éƒ¨ç½²æŒ‡å—

### Dockeréƒ¨ç½²

```dockerfile
FROM golang:1.23-alpine AS builder

WORKDIR /app
COPY . .
RUN go mod download
RUN go build -o plugin-demo examples/plugin_demo/main.go

FROM alpine:latest
RUN apk --no-cache add ca-certificates
WORKDIR /root/
COPY --from=builder /app/plugin-demo .
EXPOSE 8080
CMD ["./plugin-demo"]
```

### Docker Compose

```yaml
version: '3.8'
services:
  plugin-framework:
    build: .
    ports:
      - "8080:8080"
    environment:
      - GO_ENV=production
    depends_on:
      - redis
      - kafka
      - etcd
  
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
  
  kafka:
    image: confluentinc/cp-kafka:latest
    ports:
      - "9092:9092"
    environment:
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://localhost:9092
  
  etcd:
    image: quay.io/coreos/etcd:latest
    ports:
      - "2379:2379"
```

### Kuberneteséƒ¨ç½²

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: plugin-framework
spec:
  replicas: 3
  selector:
    matchLabels:
      app: plugin-framework
  template:
    metadata:
      labels:
        app: plugin-framework
    spec:
      containers:
      - name: plugin-framework
        image: your-registry/plugin-framework:latest
        ports:
        - containerPort: 8080
        env:
        - name: GO_ENV
          value: "production"
---
apiVersion: v1
kind: Service
metadata:
  name: plugin-framework-service
spec:
  selector:
    app: plugin-framework
  ports:
  - protocol: TCP
    port: 80
    targetPort: 8080
  type: LoadBalancer
```

## ğŸ”§ é…ç½®è¯´æ˜

### æ’ä»¶ç®¡ç†å™¨é…ç½®

```go
config := &plugin.ManagerConfig{
    EnableAutoLoad:        true,                    // å¯ç”¨è‡ªåŠ¨åŠ è½½
    AutoLoadDirectory:     "./plugins",             // æ’ä»¶ç›®å½•
    EnableHotSwap:         true,                    // å¯ç”¨çƒ­æ’æ‹”
    HealthCheckInterval:   30 * time.Second,        // å¥åº·æ£€æŸ¥é—´éš”
    EnableDependencyCheck: true,                    // å¯ç”¨ä¾èµ–æ£€æŸ¥
    MaxStartupTime:        60 * time.Second,        // æœ€å¤§å¯åŠ¨æ—¶é—´
    EnableMetrics:         true,                    // å¯ç”¨æŒ‡æ ‡æ”¶é›†
}
```

### ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `GO_ENV` | è¿è¡Œç¯å¢ƒ | `development` |
| `HTTP_PORT` | HTTPæœåŠ¡ç«¯å£ | `8080` |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | `info` |
| `REDIS_ADDR` | Redisåœ°å€ | `localhost:6379` |
| `KAFKA_BROKERS` | Kafkaåœ°å€ | `localhost:9092` |
| `ETCD_ENDPOINTS` | Etcdåœ°å€ | `localhost:2379` |

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./...

# è¿è¡Œç‰¹å®šæµ‹è¯•
go test ./framework/plugin/...

# è¿è¡ŒåŸºå‡†æµ‹è¯•
go test -bench=. ./framework/plugin/...

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
go test -cover ./...
```

## ğŸ“ˆ æ€§èƒ½ç›‘æ§

æ¡†æ¶é›†æˆäº†Prometheusç›‘æ§æŒ‡æ ‡ï¼š

```go
// æ’ä»¶æŒ‡æ ‡
plugin_count_total                    // æ’ä»¶æ€»æ•°
plugin_status{name,status}           // æ’ä»¶çŠ¶æ€
plugin_startup_duration_seconds      // æ’ä»¶å¯åŠ¨æ—¶é—´

// ä»»åŠ¡è°ƒåº¦æŒ‡æ ‡  
scheduler_tasks_total                // ä»»åŠ¡æ€»æ•°
scheduler_task_executions_total      // ä»»åŠ¡æ‰§è¡Œæ¬¡æ•°
scheduler_task_duration_seconds      // ä»»åŠ¡æ‰§è¡Œæ—¶é—´
scheduler_task_failures_total        // ä»»åŠ¡å¤±è´¥æ¬¡æ•°
```

è®¿é—® http://localhost:8080/metrics æŸ¥çœ‹ç›‘æ§æŒ‡æ ‡ã€‚

## ğŸ” å®‰å…¨è€ƒè™‘

- **æ’ä»¶éš”ç¦»**: æ’ä»¶è¿è¡Œåœ¨ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡ä¸­
- **æƒé™æ§åˆ¶**: æ’ä»¶æƒé™ç®¡ç†å’Œè®¿é—®æ§åˆ¶
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥å‚æ•°éªŒè¯
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶

## ğŸ—ºï¸ è·¯çº¿å›¾

- [ ] **v2.0.0**
  - [ ] æ’ä»¶çƒ­åŠ è½½å’ŒåŠ¨æ€æ›´æ–°
  - [ ] å›¾å½¢åŒ–ç®¡ç†ç•Œé¢
  - [ ] æ›´å¤šCronè¡¨è¾¾å¼æ”¯æŒ
  - [ ] æ’ä»¶å¸‚åœºå’Œåˆ†å‘æœºåˆ¶

- [ ] **v2.1.0**
  - [ ] åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦
  - [ ] ä»»åŠ¡ä¾èµ–ç®¡ç†
  - [ ] æ›´å¼ºçš„æ’ä»¶éš”ç¦»
  - [ ] æ€§èƒ½ä¼˜åŒ–

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼

1. **Fork** é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ **Pull Request**

### å¼€å‘æŒ‡å—

- éµå¾ª [Go Code Review Comments](https://github.com/golang/go/wiki/CodeReviewComments)
- ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°æ–‡æ¡£
- è¿è¡Œ `go fmt` å’Œ `go vet`

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [Gin](https://github.com/gin-gonic/gin) - HTTP Webæ¡†æ¶
- [Go-Redis](https://github.com/go-redis/redis) - Rediså®¢æˆ·ç«¯
- [Sarama](https://github.com/Shopify/sarama) - Kafkaå®¢æˆ·ç«¯  
- [Etcd](https://github.com/etcd-io/etcd) - åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨
- [Prometheus](https://prometheus.io/) - ç›‘æ§ç³»ç»Ÿ
- [OpenTelemetry](https://opentelemetry.io/) - å¯è§‚æµ‹æ€§æ¡†æ¶

## ğŸ“ è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/your-org/distributed-service
- **é—®é¢˜åé¦ˆ**: https://github.com/your-org/distributed-service/issues
- **è®¨è®ºåŒº**: https://github.com/your-org/distributed-service/discussions

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼ 