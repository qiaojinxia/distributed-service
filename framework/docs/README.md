# åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶æ¨¡å—æ–‡æ¡£

## ğŸ“š æ–‡æ¡£å¯¼èˆª

æ¬¢è¿ä½¿ç”¨åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ï¼æœ¬æ–‡æ¡£æä¾›äº†æ¡†æ¶å„ä¸ªæ¨¡å—çš„è¯¦ç»†è®¾è®¡æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—ã€‚

### ğŸ—‚ï¸ æ¨¡å—åˆ—è¡¨

| æ¨¡å— | åŠŸèƒ½æè¿° | æ–‡æ¡£é“¾æ¥ | çŠ¶æ€ |
|------|----------|----------|------|
| **Core** | æ¡†æ¶æ ¸å¿ƒå’Œåº”ç”¨æ„å»ºå™¨ | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../core/) | âœ… |
| **Cache** | å¤šç­–ç•¥ç¼“å­˜ç³»ç»Ÿ | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../cache/docs/) | âœ… |
| **Auth** | JWTè®¤è¯å’Œæƒé™ç®¡ç† | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../auth/docs/) | âœ… |
| **Logger** | é«˜æ€§èƒ½ç»“æ„åŒ–æ—¥å¿— | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../logger/docs/) | âœ… |
| **Database** | æ•°æ®åº“è¿æ¥å’ŒORM | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../database/docs/) | âœ… |
| **Middleware** | HTTP/gRPCä¸­é—´ä»¶ | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../middleware/docs/) | âœ… |
| **Plugin** | åŠ¨æ€æ’ä»¶ç³»ç»Ÿ | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../plugin/docs/) | âœ… |
| **Transport** | HTTP/gRPCä¼ è¾“å±‚ | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../transport/docs/) | âœ… |
| **Metrics** | ç›‘æ§æŒ‡æ ‡æ”¶é›† | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../metrics/) | ğŸš§ |
| **Tracing** | åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../tracing/) | ğŸš§ |
| **Config** | é…ç½®ç®¡ç† | [ğŸ“– æŸ¥çœ‹æ–‡æ¡£](../config/) | ğŸš§ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åŸºç¡€ä½¿ç”¨

```go
package main

import (
    "github.com/qiaojinxia/distributed-service/framework/core"
)

func main() {
    // åˆ›å»ºåº”ç”¨
    app := core.New().
        Name("my-service").
        Port(8080).
        WithCache().       // å¯ç”¨ç¼“å­˜
        WithAuth().        // å¯ç”¨è®¤è¯
        WithMetrics().     // å¯ç”¨ç›‘æ§
        WithTracing()      // å¯ç”¨è¿½è¸ª
    
    // æ³¨å†Œè·¯ç”±
    app.GET("/users", getUsersHandler)
    app.POST("/users", createUserHandler)
    
    // å¯åŠ¨æœåŠ¡
    app.Run()
}
```

### 2. é«˜çº§é…ç½®

```yaml
# config/app.yaml
app:
  name: "distributed-service"
  port: 8080
  mode: "release"
  
cache:
  default_ttl: "1h"
  max_size: 1000
  
database:
  mysql:
    host: "localhost"
    port: 3306
    database: "myapp"
    
logger:
  level: "info"
  format: "json"
  
metrics:
  enabled: true
  port: 9090
```

## ğŸ“– æ¨¡å—è¯¦ç»†ä»‹ç»

### ğŸ¯ æ ¸å¿ƒæ¨¡å— (Core)

æ¡†æ¶çš„æ ¸å¿ƒæ¨¡å—ï¼Œæä¾›åº”ç”¨æ„å»ºå™¨å’Œç»Ÿä¸€çš„APIæ¥å£ã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**
- åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
- æ¨¡å—æ³¨å†Œå’Œåˆå§‹åŒ–
- ç»Ÿä¸€é…ç½®ç®¡ç†
- ä¼˜é›…å¯åŠ¨å’Œå…³é—­

**å¿«é€Ÿä¸Šæ‰‹ï¼š**
```go
app := core.New().
    Name("my-service").
    Port(8080).
    OnlyHTTP().  // åªå¯ç”¨HTTPæœåŠ¡
    Run()
```

### ğŸ—„ï¸ ç¼“å­˜æ¨¡å— (Cache)

å¤šç­–ç•¥ç¼“å­˜ç³»ç»Ÿï¼Œæ”¯æŒLRUã€TTLã€Simpleä¸‰ç§æ·˜æ±°ç­–ç•¥ã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**
- å†…å­˜ç¼“å­˜å’ŒRedisç¼“å­˜
- å¤šç§æ·˜æ±°ç­–ç•¥
- æ¡†æ¶æ— ç¼é›†æˆ
- é«˜æ€§èƒ½è®¾è®¡

**å¿«é€Ÿä¸Šæ‰‹ï¼š**
```go
// ä½¿ç”¨æ¡†æ¶ç¼“å­˜API
userCache := core.GetUserCache()
userCache.Set(ctx, "user:123", user, time.Hour)

// ç›´æ¥åˆ›å»ºç¼“å­˜
cache, _ := cache.NewMemoryCache(cache.MemoryConfig{
    MaxSize: 1000,
    EvictionPolicy: cache.EvictionPolicyLRU,
})
```

### ğŸ” è®¤è¯æ¨¡å— (Auth)

JWTä»¤ç‰Œç®¡ç†å’Œæƒé™æ§åˆ¶ç³»ç»Ÿã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**
- JWTä»¤ç‰Œç”Ÿæˆå’ŒéªŒè¯
- å¯†ç åŠ å¯†å’Œæ ¡éªŒ
- æƒé™æ§åˆ¶ä¸­é—´ä»¶
- å¤šç§è®¤è¯æ–¹å¼

**å¿«é€Ÿä¸Šæ‰‹ï¼š**
```go
// ç”ŸæˆJWTä»¤ç‰Œ
token, _ := auth.GenerateToken(claims, "secret-key")

// éªŒè¯å¯†ç 
isValid := auth.CheckPassword(password, hashedPassword)

// ä¸­é—´ä»¶ä½¿ç”¨
r.Use(middleware.JWTAuth("secret-key"))
```

### ğŸ“ æ—¥å¿—æ¨¡å— (Logger)

åŸºäºZapçš„é«˜æ€§èƒ½ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**
- é›¶åˆ†é…é«˜æ€§èƒ½æ—¥å¿—
- ç»“æ„åŒ–å­—æ®µæ”¯æŒ
- åˆ†å¸ƒå¼è¿½è¸ªé›†æˆ
- å¼‚æ­¥å†™å…¥ä¼˜åŒ–

**å¿«é€Ÿä¸Šæ‰‹ï¼š**
```go
// åŸºç¡€æ—¥å¿—
logger.Info("ç”¨æˆ·ç™»å½•", 
    logger.String("user_id", "123"),
    logger.String("ip", "192.168.1.1"))

// å¸¦ä¸Šä¸‹æ–‡çš„æ—¥å¿—
logger.InfoContext(ctx, "å¤„ç†è®¢å•",
    logger.String("order_id", orderID))
```

### ğŸ—ƒï¸ æ•°æ®åº“æ¨¡å— (Database)

MySQLå’ŒRedisçš„ç»Ÿä¸€è®¿é—®å±‚ã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**
- GORMé›†æˆçš„MySQLæ”¯æŒ
- go-rediså®¢æˆ·ç«¯é›†æˆ
- è¿æ¥æ± ç®¡ç†
- äº‹åŠ¡æ”¯æŒ

**å¿«é€Ÿä¸Šæ‰‹ï¼š**
```go
// MySQLæ“ä½œ
db.Create(&user)
db.First(&user, userID)
db.Model(&user).Update("name", newName)

// Redisæ“ä½œ
rdb.Set(ctx, "key", "value", time.Hour)
value := rdb.Get(ctx, "key").Val()
```

### ğŸ”— ä¸­é—´ä»¶æ¨¡å— (Middleware)

HTTPå’ŒgRPCçš„ç»Ÿä¸€ä¸­é—´ä»¶ç³»ç»Ÿã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**
- è®¤è¯ã€æ—¥å¿—ã€ç›‘æ§ä¸­é—´ä»¶
- é™æµå’Œç†”æ–­æ”¯æŒ
- HTTPå’ŒgRPCç»Ÿä¸€æ¥å£
- çµæ´»çš„ä¸­é—´ä»¶ç»„åˆ

**å¿«é€Ÿä¸Šæ‰‹ï¼š**
```go
// HTTPä¸­é—´ä»¶
r.Use(middleware.Logger())
r.Use(middleware.Auth("secret-key"))
r.Use(middleware.RateLimit(100, 60))

// gRPCæ‹¦æˆªå™¨
server.AddUnaryInterceptor(middleware.UnaryAuth("secret-key"))
server.AddStreamInterceptor(middleware.StreamLogger())
```

### ğŸ”Œ æ’ä»¶æ¨¡å— (Plugin)

åŠ¨æ€æ’ä»¶åŠ è½½å’Œç®¡ç†ç³»ç»Ÿã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**
- çƒ­æ’æ‹”æ’ä»¶æ”¯æŒ
- æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†
- äº‹ä»¶é©±åŠ¨é€šä¿¡
- ä¾èµ–è§£æå’Œéš”ç¦»

**å¿«é€Ÿä¸Šæ‰‹ï¼š**
```go
// åˆ›å»ºæ’ä»¶
type MyPlugin struct {
    plugin.BasePlugin
}

func (p *MyPlugin) Start(ctx context.Context) error {
    p.EventBus().Subscribe("user.login", p.handleLogin)
    return nil
}

// æ³¨å†Œæ’ä»¶
plugin.Register("my-plugin", NewMyPlugin)
```

### ğŸŒ ä¼ è¾“æ¨¡å— (Transport)

HTTPå’ŒgRPCçš„ç»Ÿä¸€ä¼ è¾“å±‚ã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**
- HTTP/gRPCæœåŠ¡å™¨
- è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å‘ç°
- åè®®è½¬æ¢
- ç½‘å…³ä»£ç†

**å¿«é€Ÿä¸Šæ‰‹ï¼š**
```go
// HTTPæœåŠ¡å™¨
server := http.NewServer(config)
server.GET("/users", getUsersHandler)
server.Start()

// gRPCæœåŠ¡å™¨
server := grpc.NewServer(config)
pb.RegisterUserServiceServer(server.Server(), &userService{})
server.Start()
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
framework/
â”œâ”€â”€ core/           # æ ¸å¿ƒæ¨¡å—
â”œâ”€â”€ cache/          # ç¼“å­˜æ¨¡å—
â”‚   â””â”€â”€ docs/       # æ¨¡å—æ–‡æ¡£
â”œâ”€â”€ auth/           # è®¤è¯æ¨¡å—
â”‚   â””â”€â”€ docs/
â”œâ”€â”€ logger/         # æ—¥å¿—æ¨¡å—
â”‚   â””â”€â”€ docs/
â”œâ”€â”€ database/       # æ•°æ®åº“æ¨¡å—
â”‚   â””â”€â”€ docs/
â”œâ”€â”€ middleware/     # ä¸­é—´ä»¶æ¨¡å—
â”‚   â””â”€â”€ docs/
â”œâ”€â”€ plugin/         # æ’ä»¶æ¨¡å—
â”‚   â””â”€â”€ docs/
â”œâ”€â”€ transport/      # ä¼ è¾“æ¨¡å—
â”‚   â””â”€â”€ docs/
â”œâ”€â”€ metrics/        # ç›‘æ§æ¨¡å—
â”œâ”€â”€ tracing/        # è¿½è¸ªæ¨¡å—
â”œâ”€â”€ config/         # é…ç½®æ¨¡å—
â””â”€â”€ docs/           # æ¡†æ¶æ–‡æ¡£
```

### æ–‡æ¡£è§„èŒƒ

æ¯ä¸ªæ¨¡å—çš„æ–‡æ¡£åº”åŒ…å«ï¼š

1. **README.md** - ä¸»è¦è®¾è®¡æ–‡æ¡£
   - æ¨¡å—æ¦‚è¿°å’Œæ¶æ„è®¾è®¡
   - æ ¸å¿ƒç‰¹ç‚¹å’ŒåŠŸèƒ½è¯´æ˜
   - è¯¦ç»†ä½¿ç”¨ç¤ºä¾‹
   - é…ç½®é€‰é¡¹å’Œæœ€ä½³å®è·µ

2. **ARCHITECTURE.md** - æ¶æ„è®¾è®¡æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰
   - è¯¦ç»†çš„æ¶æ„å›¾å’Œè®¾è®¡æ€è·¯
   - ç»„ä»¶äº¤äº’å’Œæ•°æ®æµ
   - æ‰©å±•æ€§å’Œæ€§èƒ½è€ƒè™‘

3. **QUICKSTART.md** - å¿«é€Ÿå¼€å§‹æŒ‡å—ï¼ˆå¯é€‰ï¼‰
   - 5åˆ†é’Ÿä¸Šæ‰‹æŒ‡å—
   - å¸¸è§ä½¿ç”¨æ¨¡å¼
   - é—®é¢˜æ’æŸ¥æŒ‡å—

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æ¨¡å¼
- éµå¾ªGoè¯­è¨€æœ€ä½³å®è·µ
- æ·»åŠ å®Œæ•´çš„æ³¨é‡Šå’Œæ–‡æ¡£
- ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ä½¿ç”¨ç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼

### è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. ç¼–å†™ä»£ç å’Œæµ‹è¯•
4. æ›´æ–°æ–‡æ¡£
5. æäº¤Pull Request

## ğŸ“Š æ€§èƒ½åŸºå‡†

### åŸºç¡€æ€§èƒ½æŒ‡æ ‡

| ç»„ä»¶ | ååé‡ | å»¶è¿Ÿ | å†…å­˜ä½¿ç”¨ |
|------|--------|------|----------|
| HTTPæœåŠ¡å™¨ | 50K req/s | <1ms | 50MB |
| gRPCæœåŠ¡å™¨ | 100K req/s | <0.5ms | 30MB |
| å†…å­˜ç¼“å­˜ | 2M op/s | <1Î¼s | å¯é…ç½® |
| æ—¥å¿—ç³»ç»Ÿ | 500K log/s | <2Î¼s | 10MB |

### æ‰©å±•æ€§æŒ‡æ ‡

- **å¹¶å‘è¿æ¥**: æ”¯æŒ10K+å¹¶å‘è¿æ¥
- **æ’ä»¶æ•°é‡**: æ”¯æŒ100+æ’ä»¶åŒæ—¶è¿è¡Œ
- **é›†ç¾¤è§„æ¨¡**: æ”¯æŒ1000+èŠ‚ç‚¹é›†ç¾¤
- **æ•°æ®åº“è¿æ¥**: æ”¯æŒ1000+è¿æ¥æ± 

## ğŸ”— ç›¸å…³é“¾æ¥

- [æ¡†æ¶æºç ](https://github.com/qiaojinxia/distributed-service)
- [ç¤ºä¾‹é¡¹ç›®](../examples/)
- [APIæ–‡æ¡£](./api/)
- [éƒ¨ç½²æŒ‡å—](./deployment/)
- [ç›‘æ§æŒ‡å—](./monitoring/)

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥ï¼Ÿ

**A:** æ ¹æ®æ•°æ®ç‰¹ç‚¹é€‰æ‹©ï¼š
- **LRU**: é€‚ç”¨äºçƒ­ç‚¹æ•°æ®ç¼“å­˜
- **TTL**: é€‚ç”¨äºæœ‰æ—¶æ•ˆæ€§çš„æ•°æ®
- **Simple**: é€‚ç”¨äºé…ç½®ç±»æ•°æ®

### Q: å¦‚ä½•ä¼˜åŒ–æœåŠ¡æ€§èƒ½ï¼Ÿ

**A:** å‚è€ƒä»¥ä¸‹å»ºè®®ï¼š
- ä½¿ç”¨è¿æ¥æ± å’Œå¯¹è±¡æ± 
- å¯ç”¨å¼‚æ­¥æ—¥å¿—å’Œç›‘æ§
- åˆç†é…ç½®ç¼“å­˜å¤§å°
- ä½¿ç”¨æ‰¹é‡æ“ä½œ

### Q: å¦‚ä½•è¿›è¡Œæ•…éšœæ’æŸ¥ï¼Ÿ

**A:** æ£€æŸ¥ä»¥ä¸‹æ–¹é¢ï¼š
- æŸ¥çœ‹æ—¥å¿—å’Œç›‘æ§æŒ‡æ ‡
- æ£€æŸ¥é…ç½®æ–‡ä»¶æ­£ç¡®æ€§
- éªŒè¯ç½‘ç»œè¿æ¥çŠ¶æ€
- åˆ†ææ€§èƒ½ç“¶é¢ˆ

---

> ğŸ“§ å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»æ¡†æ¶ç»´æŠ¤å›¢é˜Ÿæˆ–æäº¤Issueã€‚